/***** PROJECT ON SQL - University Database */ 
//QUERY 1
SELECT ID, NAME FROM STUDENT WHERE ID = 113;


//QUERY 2
SELECT TITLE FROM COURSE WHERE TITLE LIKE ‘G%’;


//QUERY 3
SELECT DISTINCT ID 
FROM TEACHES 
WHERE COURSE_ID NOT IN (SELECT COURSE_ID FROM TEACHES WHERE SEMESTER='FALL' AND YEAR=2016);

//QUERY 4

SELECT NUM_ID, DEPT_NAME 
FROM (SELECT COUNT(ID) AS NUM_ID, DEPT_NAME FROM STUDENT GROUP BY DEPT_NAME) 
ORDER BY NUM_ID ASC;


//QUERY 5

WITH COUNT_ENROLLMENT AS(SELECT COURSE_ID, SEC_ID, SEMESTER, YEAR, COUNT(ID) 
AS ENROLLMENT FROM TAKES NATURAL JOIN STUDENT GROUP BY COURSE_ID, SEC_ID, SEMESTER, YEAR), MAX_ENROLLMENT
AS (SELECT COURSE_ID, SEC_ID, SEMESTER, YEAR, ENROLLMENT FROM COUNT_ENROLLMENT WHERE ENROLLMENT=(SELECT MAX(ENROLLMENT) FROM COUNT_ENROLLMENT)) 
SELECT DISTINCT NAME FROM MAX_ENROLLMENT NATURAL JOIN TEACHES NATURAL JOIN INSTRUCTOR;

//QUERY 6
/*SELECT DISTINCT ID, DISTINCT NAME, YEAR FROM TEACHES NATURAL JOIN INSTRUCTOR 
WHERE YEAR IN (SELECT DISTINCT YEAR FROM TEACHES NATURAL JOIN INSTRUCTOR WHERE NAME = 'MCKINNON') AND NAME NOT IN ('MCKINNON');
*/
SELECT DISTINCT NAME FROM TEACHES NATURAL JOIN INSTRUCTOR WHERE YEAR IN (SELECT DISTINCT YEAR FROM TEACHES NATURAL JOIN INSTRUCTOR WHERE NAME = 'MCKINNON') AND NAME NOT IN ('MCKINNON');


//QUERY 7

WITH SAL(VALUE) AS (SELECT SALARY FROM INSTRUCTOR ORDER BY SALARY DESC),
DEPT(VALUE2) AS (SELECT DEPT_NAME FROM INSTRUCTOR GROUP BY DEPT_NAME HAVING AVG(SALARY)>=ALL(SELECT AVG(SALARY) 
FROM INSTRUCTOR 
GROUP BY DEPT_NAME))
SELECT SALARY,NAME 
FROM INSTRUCTOR, SAL, DEPT 
WHERE SALARY = SAL.VALUE AND DEPT_NAME=DEPT.VALUE2 AND ROWNUM<=2;

//QUERY 8

WITH STUDENT_TAKES AS (SELECT ID, NAME, COURSE_ID, SEMESTER, YEAR, GRADE FROM STUDENT NATURAL JOIN TAKES WHERE 
DEPT_NAME='COMP. SCI.'), STUDENT_TAKES_COURSE AS (SELECT *FROM STUDENT_TAKES NATURAL JOIN COURSE ORDER BY ID, YEAR DESC) SELECT NAME, SEMESTER, YEAR, GRADE, TITLE, CREDITS FROM STUDENT_TAKES_COURSE WHERE ROWNUM<=5;

//QUERY 9

UPDATE INSTRUCTOR SET SALARY = SALARY+10000 WHERE SALARY<=50000;

//QUERY 10

DELETE FROM TAKES WHERE ID IN (SELECT ID FROM STUDENT WHERE NAME ='TOMASON');
